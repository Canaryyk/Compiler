# Simple Compiler

这是一个基于C++实现的简单编译器项目。

## 文法产生式
1 语言的文法产生式集合
·程序定义
<程序> → program <标识符> <分程序> .
<分程序> → <变量说明> <复合语句>

·语句定义
<变量说明> → var <标识符表> : <类型> ;
<标识符表> → <标识符> , <标识符表> | <标识符> 
<复合语句> → begin <语句表> end
<语句表> → <赋值语句> <语句表后缀>
<语句表后缀> → ; <语句表> | ε  
<赋值语句> → <标识符> := <算术表达式>

·算术表达式定义
<算术表达式> → <项> <算术表达式后缀>
<算术表达式后缀> → ω_0 <项> <算术表达式后缀> | ε  
<项> → <因子> <项后缀>
<项后缀> → ω_1 <因子> <项后缀> | ε  
<因子> → <算术量> | ( <算术表达式> )  
<算术量> → <标识符> | <常数>  
其中：   ω0 为 +或-
        ω1 为 *或/

·类型定义
<类型> → integer | real | char 

·单词集定义
<标识符> → <字母> <标识符后缀>
<标识符后缀> → <数字> <标识符后缀> | <字母> <标识符后缀> | ε
<常数> → <整数> | <实数>  
<整数> → <数字> <整数后缀>
<整数后缀> → <数字> <整数后缀> | ε
<实数> → <整数> . <整数>  

·字符集定义
<字母> → A | B | C | ... | Z | a | b | c | ... | z  
<数字> → 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9  

 
## 项目结构

Compiler/
├── src/
│   ├── main.cpp
│   ├── lexer/
│   │   ├── Token.h
│   │   ├── Lexer.h
│   │   └── Lexer.cpp
│   ├── parser/
│   │   ├── AST.h
│   │   ├── Parser.h
│   │   └── Parser.cpp
│   ├── semantic_analyzer/
│   │   ├── SymbolTable.h
│   │   ├── SemanticAnalyzer.h
│   │   └── SemanticAnalyzer.cpp
│   ├── code_generator/
│   │   ├── CodeGenerator.h
│   │   └── CodeGenerator.cpp
│   └── utils/
│       ├── ErrorHandler.h
│       └── ErrorHandler.cpp
├── tests/           # 测试用例
├── examples/        # 示例代码
├── CMakeLists.txt   # CMake 构建配置
└── README.md        # 项目说明
```

## 文件和目录说明

*   `.git/`: Git 版本控制目录，包含项目的版本历史和元数据。不应直接修改。
*   `README.md`: 项目的说明文件，包含项目的概述、构建指南、使用方法以及本文档（文件和目录说明）。
*   `test`: 一个空文件。其目的可能是作为占位符或用于某些特定的测试脚本。
*   `src/`: 存放编译器核心源代码的目录。
    *   `src/main.cpp`: 编译器的主入口文件。它负责解析命令行参数，初始化编译器各个组件（词法分析器、语法分析器、语义分析器、代码生成器），并按顺序调用它们来处理输入的源代码文件。
    *   `src/code_generator/`: 存放代码生成器模块的代码。此模块负责将抽象语法树（AST）或中间表示（IR）转换为目标机器代码或另一种高级语言。
        *   `CodeGenerator.h`: 代码生成器模块的头文件。通常包含 `CodeGenerator` 类的声明，定义其接口、成员变量和方法，供其他模块（主要是 `main.cpp`）调用。
        *   `CodeGenerator.cpp`: 代码生成器模块的实现文件。包含 `CodeGenerator` 类方法的具体实现，以及任何辅助函数或数据结构，用于执行代码生成逻辑，如指令选择、寄存器分配（如果适用）和最终目标代码的格式化输出。
    *   `src/lexer/`: 存放词法分析器（也称为扫描器）模块的代码。此模块负责读取源代码文本，将其分解成一系列的词法单元（tokens）。
        *   `Token.h`: 定义词法单元（Token）的结构或类。通常包含Token的类型（如关键字、标识符、操作符、字面量等）、Token的值（如标识符的名称、数字字面量的值）以及Token在源代码中的位置信息（行号、列号），便于后续的语法分析和错误报告。
        *   `Lexer.h`: 词法分析器模块的头文件。通常包含 `Lexer` 类的声明，定义其接口，如获取下一个Token的方法，以及可能的状态管理变量。
        *   `Lexer.cpp`: 词法分析器模块的实现文件。包含 `Lexer` 类方法的具体实现，负责读取输入字符流，根据词法规则识别和构建Token序列，并处理注释和空白。
    *   `src/parser/`: 存放语法分析器模块的代码。此模块负责接收词法单元流，并根据定义的语法规则构建抽象语法树（AST）。
        *   `AST.h`: 定义抽象语法树（AST）的节点类型和结构。包含各种AST节点（如表达式节点、语句节点、声明节点等）的类或结构体声明，以及它们之间的关系（如父子关系、兄弟关系）。这是编译器后续阶段（语义分析、代码生成）处理的基础数据结构。
        *   `Parser.h`: 语法分析器模块的头文件。通常包含 `Parser` 类的声明，定义其接口，如开始解析并返回AST根节点的方法。
        *   `Parser.cpp`: 语法分析器模块的实现文件。包含 `Parser` 类方法的具体实现，应用特定的语法分析算法（如递归下降、LL/LR等）来解析Token流，构建AST，并报告语法错误。
    *   `src/semantic_analyzer/`: 存放语义分析器模块的代码。此模块负责检查AST的语义正确性。
        *   `SymbolTable.h`: 符号表模块的头文件。定义符号表（SymbolTable）的类或结构，用于存储程序中声明的标识符（如变量名、函数名）及其相关信息（类型、作用域、内存位置等）。它通常提供插入、查找和管理作用域等操作的接口。
        *   `SymbolTable.cpp`: 符号表模块的实现文件。包含 `SymbolTable` 类方法的具体实现。
        *   `SemanticAnalyzer.h`: 语义分析器模块的头文件。通常包含 `SemanticAnalyzer` 类的声明，定义其接口，如遍历AST并执行语义检查的方法。
        *   `SemanticAnalyzer.cpp`: 语义分析器模块的实现文件。包含 `SemanticAnalyzer` 类方法的具体实现，负责执行类型检查、作用域解析、变量声明与使用匹配等语义规则，并更新符号表。
    *   `src/utils/`: 存放一些工具类或辅助函数，供编译器其他模块共享。
        *   `ErrorHandler.h`: 错误处理器模块的头文件。通常声明错误报告相关的函数或类，提供统一的接口来记录和显示编译过程中发现的词法错误、语法错误和语义错误。可能包括错误代码、错误信息格式化、错误位置指示等功能。
        *   `ErrorHandler.cpp`: 错误处理器模块的实现文件。包含错误报告功能的具体实现。
*   `CMakeLists.txt`: CMake 构建系统配置文件。它定义了项目的名称、依赖库、源文件、编译选项、链接规则等，指导CMake如何生成构建系统（如Makefile或Visual Studio项目）。
*   `tests/`: 存放测试代码的目录。
    *   `tests/.gitkeep`: 一个空文件，用于确保 Git 会跟踪这个空目录。
    *   职责：包含用于验证编译器各个模块功能正确性的单元测试、集成测试和回归测试。
    *   应包含代码：测试框架的配置文件、针对词法分析器、语法分析器、语义分析器、代码生成器等模块的测试用例。
*   `examples/`: 存放示例代码的目录。
    *   `examples/.gitkeep`: 一个空文件，确保 Git 跟踪此空目录。
    *   职责：包含一些使用该编译器进行编译的简单示例程序或特定语言特性的演示代码。这些示例可以帮助用户理解编译器的功能和用法，也可以作为测试编译器的输入。
    *   应包含代码：符合编译器所支持语言语法的源代码文件。

## 构建指南

1.  确保已安装 CMake (版本 >= 3.10) 和 C++ 编译器 (支持 C++17)。
2.  创建 build 目录并进入: `mkdir build && cd build`
3.  运行 CMake: `cmake ..`
4.  编译项目: `cmake --build .` (或者 `make`)

## 使用

编译完成后，可执行文件 `SimpleCompiler` (或 `SimpleCompiler.exe`) 会生成在 `build` 目录下 (或者对应平台的子目录)。

```bash
./SimpleCompiler <source_file_path>
```

## 待办


